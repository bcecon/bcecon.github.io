<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Byeong-Hak Choe">
<meta name="dcterms.date" content="2024-10-02">

<title>Homework 1 - Example Answer | Byeong-Hak Choe</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
<link rel="stylesheet" href="../assets/css/font.css">
<meta property="og:title" content="Homework 1 - Example Answer | Byeong-Hak Choe">
<meta property="og:description" content="">
<meta property="og:image" content="/assets/img/posts.png">
<meta property="og:site-name" content="Home">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/geneseo-logo-squared.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Home</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index-home.html" rel="" target="">
 <span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://bcdanl.github.io" rel="" target="_blank">
 <span class="menu-text">DANL <i class="fa-solid fa-external-link" aria-label="external-link"></i></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Homework 1 - Example Answer</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../img/geneseo-logo-squared.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
 <span class="menu-text"><a href="./index.html"><font size="6"><b>Welcome! </b></font><font size="5" color="#194493"> <i class="fa fa-sun" aria-hidden="true"></i></font></a></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../listing-econ-341-lec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><font size="5"><b>- Lecture </b></font><font size="5" color="#194493"><i class="fa-solid fa-laptop" aria-label="laptop"></i></font></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../listing-econ-341-qa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><font size="5"><b>- Q &amp; A </b></font><font size="5" color="#194493"><i class="fa-solid fa-commenting" aria-label="commenting"></i></font></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../listing-econ-341-cw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><font size="5"><b>- Classwork </b></font><font size="5" color="#194493"><i class="fa-solid fa-keyboard" aria-label="keyboard"></i></font></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../listing-econ-341-hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><font size="5"><b>- Homework </b></font><font size="5" color="#194493"><i class="fa-solid fa-level-up" aria-label="level-up"></i></font></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#question-1.-externalities-and-economic-development" id="toc-question-1.-externalities-and-economic-development" class="nav-link active" data-scroll-target="#question-1.-externalities-and-economic-development">Question 1. Externalities and Economic Development</a>
  <ul>
  <li><a href="#a" id="toc-a" class="nav-link" data-scroll-target="#a">a</a></li>
  <li><a href="#b" id="toc-b" class="nav-link" data-scroll-target="#b">b</a></li>
  <li><a href="#c" id="toc-c" class="nav-link" data-scroll-target="#c">c</a></li>
  <li><a href="#d" id="toc-d" class="nav-link" data-scroll-target="#d">d</a>
  <ul>
  <li><a href="#the-socially-optimal-level-of-oil-use" id="toc-the-socially-optimal-level-of-oil-use" class="nav-link" data-scroll-target="#the-socially-optimal-level-of-oil-use">(1) The socially optimal level of oil use</a></li>
  <li><a href="#the-deadweight-loss-dwl-due-to-pollution-at-the-market-equilibrium" id="toc-the-deadweight-loss-dwl-due-to-pollution-at-the-market-equilibrium" class="nav-link" data-scroll-target="#the-deadweight-loss-dwl-due-to-pollution-at-the-market-equilibrium">(2) The deadweight loss (<span class="math inline">\(DWL\)</span>) due to pollution at the market equilibrium</a></li>
  </ul></li>
  <li><a href="#e" id="toc-e" class="nav-link" data-scroll-target="#e">e</a>
  <ul>
  <li><a href="#the-new-market-equilibrium-price-and-quantity" id="toc-the-new-market-equilibrium-price-and-quantity" class="nav-link" data-scroll-target="#the-new-market-equilibrium-price-and-quantity">(1) The new market equilibrium price and quantity</a></li>
  <li><a href="#the-new-socially-optimal-level-of-oil-use" id="toc-the-new-socially-optimal-level-of-oil-use" class="nav-link" data-scroll-target="#the-new-socially-optimal-level-of-oil-use">(2) The new socially optimal level of oil use</a></li>
  <li><a href="#the-dwl-due-to-pollution-at-the-market-equilibrium-in-the-future" id="toc-the-dwl-due-to-pollution-at-the-market-equilibrium-in-the-future" class="nav-link" data-scroll-target="#the-dwl-due-to-pollution-at-the-market-equilibrium-in-the-future">(3) The <span class="math inline">\(DWL\)</span> due to pollution at the market equilibrium in the future</a></li>
  </ul></li>
  <li><a href="#f" id="toc-f" class="nav-link" data-scroll-target="#f">f</a></li>
  <li><a href="#g" id="toc-g" class="nav-link" data-scroll-target="#g">g</a></li>
  </ul></li>
  <li><a href="#question-2.-provision-of-public-goods" id="toc-question-2.-provision-of-public-goods" class="nav-link" data-scroll-target="#question-2.-provision-of-public-goods">Question 2. Provision of Public Goods</a>
  <ul>
  <li><a href="#a-1" id="toc-a-1" class="nav-link" data-scroll-target="#a-1">a</a></li>
  <li><a href="#b-1" id="toc-b-1" class="nav-link" data-scroll-target="#b-1">b</a></li>
  <li><a href="#c-1" id="toc-c-1" class="nav-link" data-scroll-target="#c-1">c</a></li>
  <li><a href="#d-1" id="toc-d-1" class="nav-link" data-scroll-target="#d-1">d</a></li>
  <li><a href="#e-1" id="toc-e-1" class="nav-link" data-scroll-target="#e-1">e</a></li>
  <li><a href="#f-1" id="toc-f-1" class="nav-link" data-scroll-target="#f-1">f</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Homework 1 - Example Answer</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Byeong-Hak Choe </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 2, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 2, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="question-1.-externalities-and-economic-development" class="level1">
<h1>Question 1. Externalities and Economic Development</h1>
<p>The demand function for oil is <span class="math inline">\(q_d = 4 - p\)</span>, and the supply function is <span class="math inline">\(q_s = p - 2\)</span>, where <span class="math inline">\(p\)</span> is the price of oil per barrel, and <span class="math inline">\(q\)</span> is the quantity of oil in millions of barrels per day. Using this information, solve the following problems:</p>
<section id="a" class="level2">
<h2 class="anchored" data-anchor-id="a">a</h2>
<p>Graph the supply and demand functions on the same coordinate plane.</p>
<p><strong>Answer</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="econ-341-hw-01-a_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="864"></p>
</div>
</div>
</section>
<section id="b" class="level2">
<h2 class="anchored" data-anchor-id="b">b</h2>
<p>Determine the market equilibrium price and quantity of oil.</p>
<p><strong>Answer</strong> - At the market equilibrium, the following holds: - Utility/Profit Maximization: a consumer maximizes utility; a firm maximizes profit (a firm’s version of utility). - Market Clearing: a price is such that a quantity demanded is equal to a quantity supplied.</p>
<ul>
<li>Solving the system of demand and supply equations gives the equilibrium level of quantity (<span class="math inline">\(q^{*}\)</span>) and price (<span class="math inline">\(p^{*}\)</span>): <span class="math display">\[
\begin{align}
MB(q^{*}) =\; &amp;p^{*} = MC(q^{*})\\
4 - q^{*} =\; &amp;q^{*} + 2\\
\quad\\
\therefore\quad \left\{\begin{matrix}
q^{*} = 1 \\
p^{*} = 3
\end{matrix}\right.
\end{align}
\]</span></li>
</ul>
<p><br><br></p>
</section>
<section id="c" class="level2">
<h2 class="anchored" data-anchor-id="c">c</h2>
<p>Calculate the consumer surplus and producer surplus at the market equilibrium.</p>
<p><strong>Answer</strong></p>
<ul>
<li>Consumer surplus (<span class="math inline">\(CS\)</span>) is the value that consumers receive from an allocation minus what it costs them to obtain it.
<ul>
<li><span class="math inline">\(CS\)</span> is measured as the area under the demand curve minus the consumer cost.</li>
</ul></li>
<li>Producer surplus (<span class="math inline">\(PS\)</span>) is the value that producers receive from an allocation minus what it costs them to supply it.
<ul>
<li><span class="math inline">\(PS\)</span> is measured as the area above the supply curve and below the market price line.</li>
</ul></li>
<li>Therefore, <span class="math inline">\(CS = \frac{1}{2}\)</span> and <span class="math inline">\(PS = \frac{1}{2}\)</span>.</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="econ-341-hw-01-a_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p><br><br></p>
</section>
<section id="d" class="level2">
<h2 class="anchored" data-anchor-id="d">d</h2>
<p>Oil consumption causes environmental damage. Suppose the marginal damage of oil pollution is given by <span class="math inline">\(MD = q + 1\)</span>. Calculate:</p>
<section id="the-socially-optimal-level-of-oil-use" class="level3">
<h3 class="anchored" data-anchor-id="the-socially-optimal-level-of-oil-use">(1) The socially optimal level of oil use</h3>
<p><strong>Answer</strong> The social marginal cost (<span class="math inline">\(SMC\)</span>) is: <span class="math display">\[
\begin{align}
SMC &amp;\,=\, MD + MC\\
&amp;\,=\, 2q + 3
\end{align}
\]</span> At the socially optimum <span class="math inline">\((q^{o}, p^{o})\)</span>, the social marginal cost of oil use is equal to the (social) marginal benefit:</p>
<p><span class="math display">\[
\begin{align}
SMC &amp;\,=\, MB\\
2q^{o} + 3 &amp;\,=\, 4 - q^{o}
\end{align}
\]</span> Therefore, <span class="math inline">\(q^{o} = \frac{1}{3}\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="econ-341-hw-01-a_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p><br><br></p>
</section>
<section id="the-deadweight-loss-dwl-due-to-pollution-at-the-market-equilibrium" class="level3">
<h3 class="anchored" data-anchor-id="the-deadweight-loss-dwl-due-to-pollution-at-the-market-equilibrium">(2) The deadweight loss (<span class="math inline">\(DWL\)</span>) due to pollution at the market equilibrium</h3>
<ul>
<li>Deadweight loss (<span class="math inline">\(DWL\)</span>) is the loss of economic efficiency that occurs when the optimal or equilibrium outcome is not achieved in a market.
<ul>
<li>What will happen if the firm produces at <span class="math inline">\(q^{*}\)</span>, instead of <span class="math inline">\(q^{o}\)</span>?
<ul>
<li>The total economic surplus (<span class="math inline">\(TES = CS + PS\)</span>) is the same as in question (c).</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="econ-341-hw-01-a_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<ul>
<li>However, pollution imposes a total external cost on society.
<ul>
<li>This external cost is measured by the vertical distance between the Social Marginal Cost (<span class="math inline">\(SMC\)</span>) and the private Marginal Cost (<span class="math inline">\(MC\)</span>) up to the production level <span class="math inline">\(q^{*} = 1\)</span>.</li>
<li>Note that <span class="math inline">\(MD = SMC - MC\)</span>.</li>
<li>Imagine building up the total external cost unit by unit. For each unit of oil production, you add its marginal damage to society. The sum of all these marginal damage gives you the total external cost. Graphically, this summation is represented by the vertical distance between <span class="math inline">\(SMC\)</span> and <span class="math inline">\(MC\)</span>.</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="econ-341-hw-01-a_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<ul>
<li>Therefore, <span class="math inline">\(DWL\)</span> can be calculated as the difference between the total economic surplus and the total external cost in the economy: <span class="math display">\[
\begin{align}
DWL &amp;= \frac{1}{2}\times\left(1 - \frac{1}{3}\right)\times\left(5 - 3\right)\\
&amp;= \frac{2}{3}
\end{align}
\]</span></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="econ-341-hw-01-a_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="864"></p>
</div>
</div>
</section>
</section>
<section id="e" class="level2">
<h2 class="anchored" data-anchor-id="e">e</h2>
<p>Due to economic development, the future demand for oil increases, resulting in a new demand function <span class="math inline">\(q_d' = 8 - p\)</span>. Determine (1) the new market equilibrium price and quantity, (2) the new socially optimal level of oil use, and (3) the <span class="math inline">\(DWL\)</span> due to pollution at the market equilibrium in the future.</p>
<section id="the-new-market-equilibrium-price-and-quantity" class="level3">
<h3 class="anchored" data-anchor-id="the-new-market-equilibrium-price-and-quantity">(1) The new market equilibrium price and quantity</h3>
<p><strong>Answer</strong> In the equilibrium, the price is such that the market clears:</p>
<p><span class="math display">\[
8 - q^{**} = q^{**} + 2
\]</span> Therefore, the new equilibrium quantity is <span class="math inline">\(q^{**} = 3\)</span>, and the new equilibrium price is <span class="math inline">\(p^{**}=5\)</span>.</p>
<p><br><br></p>
</section>
<section id="the-new-socially-optimal-level-of-oil-use" class="level3">
<h3 class="anchored" data-anchor-id="the-new-socially-optimal-level-of-oil-use">(2) The new socially optimal level of oil use</h3>
<p><strong>Answer</strong> At the new socially optimum <span class="math inline">\(q^{oo}\)</span>, the social marginal benefit of the oil use is equal to the social marginal cost of the oil use:</p>
<p><span class="math display">\[
8 - q^{oo} = 2q^{oo} + 3
\]</span> Therefore, the new socially optimal level of oil use is <span class="math inline">\(q^{oo} = \frac{5}{3}\)</span>.</p>
<p><br><br></p>
</section>
<section id="the-dwl-due-to-pollution-at-the-market-equilibrium-in-the-future" class="level3">
<h3 class="anchored" data-anchor-id="the-dwl-due-to-pollution-at-the-market-equilibrium-in-the-future">(3) The <span class="math inline">\(DWL\)</span> due to pollution at the market equilibrium in the future</h3>
<ul>
<li>Deadweight loss (<span class="math inline">\(DWL\)</span>) is the loss of economic efficiency that occurs when the optimal or equilibrium outcome is not achieved in a market.
<ul>
<li>What will happen if the firm produces at <span class="math inline">\(q^{**}\)</span>, instead of <span class="math inline">\(q^{oo}\)</span>?
<ul>
<li>The total economic surplus (<span class="math inline">\(TES = CS + PS\)</span>) is described as below.</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="econ-341-hw-01-a_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<ul>
<li>However, producing at <span class="math inline">\(q^{**} = 3\)</span> creates the total external cost, the vertical distance between <span class="math inline">\(SMC\)</span> and <span class="math inline">\(MC\)</span></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="econ-341-hw-01-a_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<ul>
<li>Therefore <span class="math inline">\(DWL\)</span> can be calculated as the difference between the total surplus and the total external cost in the market: <span class="math display">\[
\begin{align}
DWL &amp;= \frac{1}{2}\times\left(3 - \frac{5}{3}\right)\times\left(9 - 5\right)\\
&amp;= \frac{8}{3}
\end{align}
\]</span></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="econ-341-hw-01-a_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="864"></p>
</div>
</div>
</section>
</section>
<section id="f" class="level2">
<h2 class="anchored" data-anchor-id="f">f</h2>
<p>Propose and briefly explain two distinct public policies that could be implemented to mitigate the environmental damages and reduce the burden on future generations. Discuss the potential effectiveness and challenges of each policy.</p>
<p><strong>Answer</strong></p>
<ul>
<li><p>Government can implement the two market-based policy instruments. <a href="https://bcecon.github.io/econ-lec/econ-341-lec-07-2024-0911.html?q=corrective#/the-pursuit-of-efficiency-12">This lecture slide</a> explains these policy instruments.</p></li>
<li><p>Besides, government can invest in renewable energy by providing direct funding for clean energy projects (solar, wind, etc.)</p>
<ul>
<li>Policy: Provide direct funding for clean energy projects (solar, wind, etc.)</li>
<li>Benefits:
<ul>
<li>Directly reduces emissions through cleaner energy production</li>
<li>Stimulates job creation in the green energy sector</li>
<li>Decreases dependence on fossil fuels</li>
</ul></li>
<li>Challenges:
<ul>
<li>High upfront costs with potential impact on government budgets</li>
<li>Overcoming existing fossil fuel infrastructure lock-in</li>
<li>Resistance from the established fossil fuel industry</li>
<li>Ensuring efficient allocation of resources across various projects</li>
</ul></li>
<li>Long-term Impact: Accelerates transition to a low-carbon economy, potentially reducing future environmental mitigation costs.</li>
</ul></li>
</ul>
<p><br><br></p>
</section>
<section id="g" class="level2">
<h2 class="anchored" data-anchor-id="g">g</h2>
<p>Suppose the government decides to impose a Pigouvian tax to internalize the external costs of oil pollution. Calculate the optimal tax rates in the present and in the future and explain how it would affect the market equilibrium and social welfare.</p>
<p><strong>Answer</strong></p>
<ul>
<li>Corrective Taxation (Pigouvian Tax) for Oil Production:
<ul>
<li>To address the negative externality imposed by oil production, we are considering implementing a price instrument known as corrective taxation, or Pigouvian tax. This policy involves setting a per-unit tax equal to the marginal environmental damage caused by oil production.</li>
</ul></li>
</ul>
<p><span class="math display">\[
\begin{align}
\text{Present}:&amp;\quad t^{o} = MD(q^{o}) = q^{o} + 1\\
\text{Future}:&amp;\quad t^{oo} = MD(q^{oo}) = q^{oo} + 1
\end{align}
\]</span> - Therefore, the Pigouvian tax rate in the present is <span class="math inline">\(t^{o} = \frac{4}{3}\)</span>, and the Pigouvian tax in the future is <span class="math inline">\(t^{oo} = \frac{8}{3}\)</span>.</p>
<ul>
<li><p>The aim is to internalize the external costs, aligning private costs with social costs (Under this Pigouvian tax scheme, the <span class="math inline">\(SMC\)</span> curve becomes the firm’s private marginal cost).</p></li>
<li><p>Effect on Market Equilibrium and Social Welfare:</p>
<ul>
<li><p>The implementation of a Pigouvian tax would significantly alter the market equilibrium. The supply curve would shift upward by the amount of the tax, resulting in a new equilibrium with a higher price and lower quantity. Producers would bear part of the tax burden, reducing their producer surplus, while consumers would face higher prices, diminishing their consumer surplus.</p></li>
<li><p>In terms of social welfare, the deadweight loss from the negative externality disappears as production moves to the socially optimal level. The social welfare increases to the optimal level as environmental costs are internalized.</p>
<ul>
<li>From an economic efficiency standpoint, the tax would encourage more efficient use of resources by incorporating environmental costs into market prices. This promotes an allocation of resources that better reflects true social costs and benefits.</li>
</ul></li>
<li><p>Additionally, the revenue generated from the tax could potentially be used for environmental mitigation efforts or to offset other taxes, further influencing overall social welfare.</p></li>
</ul></li>
</ul>
<!-- The distributional effects of the tax would depend on the relative elasticities of supply and demand, with the burden shared between producers and consumers. Industries and consumers heavily reliant on oil may face higher costs in the short term, but this creates long-term incentives for innovation in cleaner technologies and alternative energy sources. -->
<!-- However, implementing such a policy faces several challenges. These include accurately measuring and quantifying environmental damage to set the correct tax rate, managing potential economic impacts on oil-dependent industries and regions, overcoming political resistance from oil producers and consumers, and addressing concerns about regressivity, as higher energy prices may disproportionately affect lower-income households. -->
<!-- By considering these effects on market equilibrium and social welfare, we gain a more comprehensive understanding of the policy's impacts and its economic rationale in addressing the environmental externalities of oil production. -->
<p><br><br><br></p>
</section>
</section>
<section id="question-2.-provision-of-public-goods" class="level1">
<h1>Question 2. Provision of Public Goods</h1>
<p>A community lives near a forest. The forest provides wood, which the villagers can use for various purposes like heating, building, or selling. However, the forest also acts as a carbon sink, absorbing carbon dioxide and providing fresh air, and is home to various wildlife. If too many trees are cut down, the forest will degrade, leading to loss of these environmental benefits.</p>
<p>There are <span class="math inline">\(N\)</span> number of identical villagers. Each villager is endowed with <span class="math inline">\(\$y\)</span>, and must decide how much of their endowment to invest in a communal fund for forest conservation and how much to keep for themselves. Let <span class="math inline">\(g_{i}\)</span> denote each villager’s contribution to the communal fund.</p>
<p>The total amount of dollars in the communial fund is multiplied by some constant factor <span class="math inline">\(R\)</span>, where <span class="math inline">\(1 &lt; R &lt; N\)</span>. The multiplied amount is then equally distributed among all villagers, irrespective of their individual contributions.</p>
<p>Each villager <span class="math inline">\(i\)</span>’s utility is as follows: <span class="math display">\[
\begin{align}
U_{i} &amp;= y - g_{i} + \frac{R}{N} \times G\\
&amp;= y - g_{i} + \frac{R}{N} \times \left(\, g_{i} + G_{-i} \,\right),
\end{align}
\]</span> where <span class="math inline">\(G\)</span> is the total amount of dollars collected for the communial fund, and <span class="math inline">\(G_{-i} = G - g_{i}\)</span>.</p>
<section id="a-1" class="level2">
<h2 class="anchored" data-anchor-id="a-1">a</h2>
<p>Using calculus and graph, determine the equilibrium contribution (<span class="math inline">\(g_{i}^{*}\)</span>) for each villager.</p>
<p><strong>Answer</strong></p>
<p>In the equilibrium, each villager <span class="math inline">\(i\)</span> maximizes his or her utility by choosing <span class="math inline">\(g_{i}\)</span>:</p>
<p><span class="math display">\[
\begin{align}
\max_{0\leq\, q_{i}\leq y}\;U_{i} &amp;= y - g_{i} + \frac{R}{N} \times G\tag{villager-i}\\
&amp;= y - g_{i} + \frac{R}{N} \times \left(\, g_{i} + G_{-i} \,\right)
\end{align}
\]</span> The first order condition to problem (villager-i) is:</p>
<p><span class="math display">\[
\begin{align}
\frac{dU_{i}}{dg_{i}} \,=\, -1 + \frac{R}{N} \, &lt; \, 0.\tag{FOC-i}
\end{align}
\]</span> (FOC-i) implies that the marginal utility of increasing one unit of <span class="math inline">\(g_{i}\)</span> is always negative. Since all villagers are identical, <span class="math inline">\(g_{i}^{*} = 0\)</span> for all <span class="math inline">\(i=1,\cdots, N\)</span>.</p>
<ul>
<li>The utility function <span class="math inline">\(U_{i}\)</span> of villager <span class="math inline">\(i\)</span>, in relation to their contribution <span class="math inline">\(g_{i}\)</span>, can be graphically represented as follows, holding all other villagers’ contributions remain constant:</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="econ-341-hw-01-a_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p><br><br></p>
</section>
<section id="b-1" class="level2">
<h2 class="anchored" data-anchor-id="b-1">b</h2>
<p>The forest manager, who is external to the community, aims to maximize the community’s social welfare (<span class="math inline">\(SW\)</span>). Note that the social welfare is the sum of the individual villager’s utility. Calculate the socially optimal level of <span class="math inline">\(g_i\)</span> that maximizes <span class="math inline">\(SW\)</span>. How does this differ from the equilibrium contribution?</p>
<p><span class="math display">\[
\begin{align}
SW &amp;= U_{1} + U_{2} + \cdots + U_{N}\\
&amp;= N \times U_{i}\qquad\text{ for any villager }\; i = 1, 2, \cdots, N\\
&amp;= N \times \left(\,y - g_{i} + \frac{R}{N} \times G\,\right) \\
&amp;= Ny +( R - 1 )\times G\\
&amp;= Ny +( R - 1 )\times (G_{-i} + g_{i})\\
&amp;= Ny +( R - 1 )\times (g_{1} + g_{2} + \cdots + g_{N})
\end{align}
\]</span></p>
<p><strong>Answer</strong></p>
<ul>
<li>The forest manager aims to maximize the community’s social welfare (<span class="math inline">\(SW\)</span>) by optimally allocating the total contributions from all villagers:</li>
</ul>
<p><span class="math display">\[
\begin{align}
\max_{g_{1}, g_{2}, \cdots, g_{N}}\, SW = Ny +( R - 1 )\times (g_{1} + g_{2} + \cdots + g_{N})\tag{manager}
\end{align}
\]</span></p>
<p>The first-order condition for problem (manager) is:</p>
<p><span class="math display">\[
\begin{align}
\frac{\partial U_{i}}{\partial g_{i}} \,=\, R - 1 \, &gt; \, 0 \quad\text{for all }i = 1,\cdots, N.\tag{FOC-manager-i}
\end{align}
\]</span></p>
<ul>
<li><p>The first-order condition (FOC-manager-i) implies that the marginal social welfare of increasing villager <span class="math inline">\(i\)</span>’s contribution is always positive. Since all villagers are identical, <span class="math inline">\(g_{i}^{o} = y\)</span> for all <span class="math inline">\(i=1,\cdots, N\)</span>.</p></li>
<li><p>The social welfare function <span class="math inline">\(SW\)</span>, in relation to a villager <span class="math inline">\(i\)</span>’s contribution <span class="math inline">\(g_{i}\)</span>, can be graphically represented as follows, holding all other villagers’ contributions remain constant:</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="econ-341-hw-01-a_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p><br><br></p>
</section>
<section id="c-1" class="level2">
<h2 class="anchored" data-anchor-id="c-1">c</h2>
<p>The forest manager decides to implement a matching grant program to encourage contributions to the forest conservation fund. For every dollar contributed by a villager, the program will contribute an additional <span class="math inline">\(m\)</span> dollars (where <span class="math inline">\(0 &lt; m &lt; 1\)</span>). The utility function for each villager <span class="math inline">\(i\)</span> now becomes: <span class="math display">\[
\begin{align}
U_{i}^{'} &amp;= y - g_{i} + \frac{R}{N} \times (1 + m) \times G\\
&amp;= y - g_{i} + \frac{R}{N} \times (1 + m) \times \left(\, g_{i} + G_{-i} \,\right),
\end{align}
\]</span></p>
<p>Determine the minimum value of <span class="math inline">\(m\)</span> that would induce villagers to contribute the socially optimal level of <span class="math inline">\(g_i\)</span> found in part (b). Show your work.</p>
<p><strong>Answer</strong></p>
<p>In the equilibrium under this program, each villager <span class="math inline">\(i\)</span> maximizes his or her utility by choosing <span class="math inline">\(g_{i}\)</span>:</p>
<p><span class="math display">\[
\begin{align}
\max_{0\leq\, q_{i}\leq y}\;U_{i}^{'} &amp;= y - g_{i} + \frac{R}{N}\times (1 + m)  \times G\tag{villager-i'}\\
&amp;= y - g_{i} + \frac{R}{N}\times (1 + m)  \times \left(\, g_{i} + G_{-i} \,\right)
\end{align}
\]</span> The first order condition to problem (villager-i’) is:</p>
<p><span class="math display">\[
\begin{align}
\frac{dU_{i}^{'}}{dg_{i}} \,=\, -1 + \frac{R}{N}\times(1+m)\,\geq\, 0 \tag{FOC-i'}
\end{align}
\]</span></p>
<ul>
<li>Note that the marginal utility of contribution under this program, <span class="math inline">\(\frac{dU_i}{dg_i}\)</span>, can range from 0 to a positive value, depending on <span class="math inline">\(m\)</span>. There exists a minimum value, <span class="math inline">\(m^{o}\)</span>, that incentivizes a villager <span class="math inline">\(i\)</span> to contribute their entire endowment <span class="math inline">\(y\)</span>:</li>
</ul>
<p><span class="math display">\[
\frac{dU_{i}^{'}}{dg_{i}} \,=\,-1 + \frac{R}{N}\times(1+m^{o}) = 0
\]</span> Therefore, <span class="math inline">\(m^{o} = \frac{N}{R} - 1\)</span>.</p>
<p><br><br></p>
</section>
<section id="d-1" class="level2">
<h2 class="anchored" data-anchor-id="d-1">d</h2>
<p>Using the minimum value of <span class="math inline">\(m\)</span> found in part (c), calculate the total cost of implementing the matching grant program to the forest manager. Assume all villagers contribute the socially optimal amount.</p>
<p><strong>Answer</strong></p>
<p>The <em>minimized</em> total cost of the matching grant program when everyone contributes <span class="math inline">\(y\)</span> is:</p>
<p><span class="math display">\[
\text{Cost}^{o} \,=\, N \times m^{o} \times y
\]</span></p>
<p><br><br></p>
</section>
<section id="e-1" class="level2">
<h2 class="anchored" data-anchor-id="e-1">e</h2>
<p>Calculate the change in social welfare (<span class="math inline">\(\Delta SW = SW^{'} - SW\)</span>) with the introduction of the matching grant program. Compare this change to the cost of the program calculated in part (d). Is the change in <span class="math inline">\(SW\)</span> greater than, equal to, or less than the cost of the program to the forest manager? Justify your answer analytically.</p>
<p><strong>Answer</strong></p>
<ul>
<li>The change in social welfare due to the program is:</li>
</ul>
<p><span class="math display">\[
\begin{align}
\Delta SW &amp;= SW^{o'} - SW^{*} \\
&amp;= \left(N \times \left(\,y - g_{i}^{o} + \frac{R}{N} \times (1+m^{o})\times G^{o}\,\right)\right) - \left(N \times \left(\,y - g_{i}^{*} + \frac{R}{N} \times G^{*}\,\right)\right) \\
&amp;= \left(N \times \left(\,y - y + \frac{R}{N} \times (1+m^{o})\times Ny\,\right)\right) - \left(N \times \left(\,y - 0 + \frac{R}{N} \times 0\,\right)\right) \\
&amp;= NR(1+m^{o})y - Ny\\
&amp;= Ny(R(1+m^{o}) - 1)\\
&amp;= Ny\left(R\left(1+\frac{N}{R} - 1\right) - 1\right)\quad \because\; m^{o} = \frac{N}{R} - 1\\
&amp;= Ny\left(N - 1\right) \,&gt;\, 0
\end{align}
\]</span> Therefore, <span class="math inline">\(\Delta SW &gt; 0\)</span>.</p>
<p>Now let’s compare <span class="math inline">\(\Delta SW\)</span> with the cost of the program: <span class="math display">\[
\begin{align}
\Delta SW - Cost^{o} &amp;= Ny\left(N - 1\right) - Nm^{o}y\\
&amp;= Ny(N-1-m^{o})\\
&amp;= Ny\left( N - \frac{N}{R} \right)\quad \because\; 1 + m^{o} = \frac{N}{R}\\
&amp;= N^{2}y\left(1 - \frac{1}{R}\right) \,&gt;\, 0\quad \because\; R &gt; 1\\
\end{align}
\]</span> Therefore, the increase in <span class="math inline">\(SW\)</span> is greater than the minimzied cost of the program, justifying the action of the program!</p>
<p><br><br></p>
</section>
<section id="f-1" class="level2">
<h2 class="anchored" data-anchor-id="f-1">f</h2>
<p>Discuss the practical implications and potential challenges of implementing such a matching grant program in the context of community forest management.</p>
<p><strong>Answer</strong> 1. Funding: Securing sustainable funding for the matching grant program could be challenging, especially in resource-constrained environments.</p>
<ol start="2" type="1">
<li><p>Equity concerns: The program might disproportionately benefit wealthier villagers who can afford larger contributions.</p></li>
<li><p>Long-term sustainability: There’s a risk of creating dependency on the matching grants, potentially reducing intrinsic motivation for conservation.</p></li>
<li><p>Administrative costs: Implementing and monitoring the program would require resources and could be complex in a village setting.</p></li>
<li><p>Potential for strategic behavior: Villagers might coordinate to maximize the matching funds, which could lead to inefficiencies.</p></li>
<li><p>Calibration: Determining the optimal matching rate m in practice could be difficult and may need to be adjusted over time.</p></li>
<li><p>Spillover effects: The program might have positive externalities by fostering a culture of conservation and community cooperation.</p></li>
</ol>
<p>This analysis demonstrates how a matching grant can theoretically solve the free-rider problem, but also highlights the practical challenges in implementing such a program. It underscores the complexity of designing effective policies for managing common pool resources like forests.</p>
<p><br><br></p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">powered with github, quarto, and rstudio<br>byeong-hak choe, 2024</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<div id="scroll-padding"></div>
<script src="../assets/js/site.js"></script>
<script src="../assets/js/posts.js"></script>



</body></html>